<h6 id="to-start-the-database"><a class="heading-anchor" href="#to-start-the-database" data-link>To start the database</a></h6>
<div class="code-block"><span class="code-lang">shell</span><button class="copy-btn" aria-label="Copy code">Copy</button><pre><code class="language-shell">initdb /usr/local/var/postgres
</code></pre></div>
<p>The above command is the same as</p>
<div class="code-block"><button class="copy-btn" aria-label="Copy code">Copy</button><pre><code>initdb -D /usr/local/var/postgres
</code></pre></div>
<p>From the syntax</p>
<div class="code-block"><span class="code-lang">shell</span><button class="copy-btn" aria-label="Copy code">Copy</button><pre><code class="language-shell">initdb [--pgdata | -D] directory
</code></pre></div>
<p><em>from the manual pages</em></p>
<div class="code-block"><button class="copy-btn" aria-label="Copy code">Copy</button><pre><code>-D directory
       --pgdata=directory
           This option specifies the directory where the database cluster should be stored. This is the only information required by initdb, but you can avoid writing it by setting the PGDATA environment variable, which can be convenient since the database server (postgres) can find the database directory later by the same variable.
</code></pre></div>
<p>So the database is started with storage at location specified by the <code>-D</code> flag.
Upon running the <code>initdb</code> command this the output</p>
<div class="code-block"><button class="copy-btn" aria-label="Copy code">Copy</button><pre><code>The files belonging to this database system will be owned by user &quot;g_joss&quot;.
This user must also own the server process.
The database cluster will be initialized with locale &quot;en_US.UTF-8&quot;.
The default database encoding has accordingly been set to &quot;UTF8&quot;.
The default text search configuration will be set to &quot;english&quot;.
Data page checksums are disabled.
creating directory /usr/local/var/postgres ... ok
creating subdirectories ... ok
selecting dynamic shared memory implementation ... posix
selecting default max_connections ... 100
selecting default shared_buffers ... 128MB
selecting default time zone ... America/Chicago
creating configuration files ... ok running bootstrap script ... ok
performing post-bootstrap initialization ... ok
syncing data to disk ... ok
initdb: warning: enabling &quot;trust&quot; authentication for local connections
You can change this by editing pg_hba.conf or using the option -A, or
--auth-local and --auth-host, the next time you run initdb.
Success. You can now start the database server using:
    pg_ctl -D /usr/local/var/postgres -l logfile start
</code></pre></div>
<p>To verify there is currently no database connection currently</p>
<div class="code-block"><span class="code-lang">shell</span><button class="copy-btn" aria-label="Copy code">Copy</button><pre><code class="language-shell">ps aux | grep postgres           
</code></pre></div>
<p>output
<code>g_joss           53091   0.0  0.0 34130532    656 s000  S+   10:55PM   0:00.01 grep postgres</code>
The only found process is the <code>grep</code> search
Now run,</p>
<div class="code-block"><span class="code-lang">shell</span><button class="copy-btn" aria-label="Copy code">Copy</button><pre><code class="language-shell">pg_ctl -D /usr/local/var/postgres -l logfile start
</code></pre></div>
<p>output
<code>waiting for server to start.... done</code>
<code>server started</code>
Re-run
<code>ps aux | grep postgres</code>
And find,</p>
<div class="code-block"><button class="copy-btn" aria-label="Copy code">Copy</button><pre><code>g_joss           53174   0.0  0.0 34138724    684 s000  S+   10:59PM   0:00.01 grep postgres

g_joss           53118   0.0  0.0 34338896   1684   ??  Ss   10:56PM   0:00.00 postgres: logical replication launcher   

g_joss           53117   0.0  0.0 34193320    900   ??  Ss   10:56PM   0:00.00 postgres: stats collector   

g_joss           53116   0.0  0.0 34338896   1980   ??  Ss   10:56PM   0:00.00 postgres: autovacuum launcher   

g_joss           53115   0.0  0.1 34338704   5204   ??  Ss   10:56PM   0:00.01 postgres: walwriter   

g_joss           53114   0.0  0.0 34338704   2288   ??  Ss   10:56PM   0:00.03 postgres: background writer   

g_joss           53113   0.0  0.0 34338704   1040   ??  Ss   10:56PM   0:00.00 postgres: checkpointer   

g_joss           53111   0.0  0.2 34339012  14608   ??  Ss   10:56PM   0:00.04 /Applications/Postgres.app/Contents/Versions/14/bin/postgres -D /usr/local/var/postgres
</code></pre></div>
<p>Also to check the status</p>
<div class="code-block"><span class="code-lang">shell</span><button class="copy-btn" aria-label="Copy code">Copy</button><pre><code class="language-shell">pg_ctl -D /usr/local/var/postgres status
</code></pre></div>
<p>Create the database</p>
<div class="code-block"><span class="code-lang">shell</span><button class="copy-btn" aria-label="Copy code">Copy</button><pre><code class="language-shell"> psql -d postgres -c &quot;CREATE DATABASE manu_biz;&quot;
</code></pre></div>
<p>The schema is defined in the file <code>manu_biz_schema.db</code></p>
<div class="code-block"><button class="copy-btn" aria-label="Copy code">Copy</button><pre><code>psql -U g_joss -d manu_biz -f manu_biz_schema.sql
</code></pre></div>
<p>The above command outputs</p>
<div class="code-block"><button class="copy-btn" aria-label="Copy code">Copy</button><pre><code>CREATE TABLE
CREATE TABLE
CREATE TABLE
CREATE TABLE
CREATE TABLE
CREATE TABLE
</code></pre></div>
<p>To populate the data</p>
<div class="code-block"><span class="code-lang">shell</span><button class="copy-btn" aria-label="Copy code">Copy</button><pre><code class="language-shell">psql -U g_joss -d biz_manu -f init_manu_biz.sql
</code></pre></div>
<p>Ouputs</p>
<div class="code-block"><button class="copy-btn" aria-label="Copy code">Copy</button><pre><code>INSERT 0 3
INSERT 0 3
INSERT 0 3
INSERT 0 2
INSERT 0 5
INSERT 0 2
</code></pre></div>
<p>Verify things have been added</p>
<div class="code-block"><span class="code-lang">shell</span><button class="copy-btn" aria-label="Copy code">Copy</button><pre><code class="language-shell">psql -U g_joss -d biz_manu -c &quot;SELECT * FROM Employees;&quot;
</code></pre></div>
<p>Stop then delete,</p>
<div class="code-block"><button class="copy-btn" aria-label="Copy code">Copy</button><pre><code>pg_ctl -D /usr/local/var/postgres stop
rm -rf /usr/local/var/postgres
</code></pre></div>
