/* ===== CSS Variables ===== */

/* Dark theme (default) */
:root, [data-theme="dark"] {
	--sidebar-width: 260px;
	--bg-primary: #1a1a2e;
	--bg-secondary: #16213e;
	--bg-content: #0f0f23;
	--text-primary: #e4e4e7;
	--text-secondary: #a1a1aa;
	--accent: #60a5fa;
	--folder-color: #fbbf24;
	--file-color: #34d399;
	--border: #27273a;
	--hover: #27273a;
	--active: #3b3b5c;
}

/* Light theme */
[data-theme="light"] {
	--bg-primary: #f0f0f5;
	--bg-secondary: #ffffff;
	--bg-content: #f8f8fc;
	--text-primary: #1a1a2e;
	--text-secondary: #52525b;
	--accent: #2563eb;
	--folder-color: #d97706;
	--file-color: #059669;
	--border: #d4d4d8;
	--hover: #e4e4e7;
	--active: #d1d5db;
}

/* Retro theme */
[data-theme="retro"] {
	--bg-primary: #2b1b0e;
	--bg-secondary: #3c2415;
	--bg-content: #1e1008;
	--text-primary: #ffd59a;
	--text-secondary: #c49a6c;
	--accent: #ff9f43;
	--folder-color: #f0c040;
	--file-color: #66cc99;
	--border: #5a3a1e;
	--hover: #4a2e14;
	--active: #6b4226;
}

/* ===== Reset ===== */
*, *::before, *::after {
	margin: 0;
	padding: 0;
	box-sizing: border-box;
}

html, body {
	height: 100%;
	font-family: system-ui, -apple-system, sans-serif;
	font-size: 14px;
	background: var(--bg-content);
	color: var(--text-primary);
}

a { color: var(--accent); text-decoration: none; }
a:hover { text-decoration: underline; }

/* ===== Top Navigation Bar ===== */
.top-nav {
	display: flex;
	align-items: center;
	justify-content: space-between;
	height: 48px;
	padding: 0 20px;
	background: var(--bg-secondary);
	border-bottom: 1px solid var(--border);
	position: sticky;
	top: 0;
	z-index: 300;
	flex-shrink: 0;
}

.top-nav-brand a {
	font-size: 16px;
	font-weight: 700;
	color: var(--text-primary);
	letter-spacing: 0.5px;
}

.top-nav-brand a:hover {
	text-decoration: none;
	color: var(--accent);
}

.top-nav-links {
	display: flex;
	gap: 4px;
}

.nav-link {
	padding: 6px 14px;
	border-radius: 6px;
	font-size: 13px;
	font-weight: 500;
	color: var(--text-secondary);
	transition: background 0.15s, color 0.15s;
}

.nav-link:hover {
	background: var(--hover);
	color: var(--text-primary);
	text-decoration: none;
}

.nav-link.active {
	background: var(--active);
	color: var(--text-primary);
}

/* ===== Theme Toggle ===== */
.theme-toggle {
	background: none;
	border: 1px solid var(--border);
	border-radius: 6px;
	width: 34px;
	height: 34px;
	cursor: pointer;
	display: flex;
	align-items: center;
	justify-content: center;
	margin-left: 8px;
	transition: background 0.15s;
}

.theme-toggle:hover {
	background: var(--hover);
}

.theme-icon {
	font-size: 16px;
	line-height: 1;
}

/* ===== App Layout ===== */
.app {
	display: flex;
	height: calc(100vh - 48px);
	overflow: hidden;
}

/* ===== Sidebar ===== */
.sidebar {
	width: var(--sidebar-width);
	min-width: var(--sidebar-width);
	background: var(--bg-secondary);
	border-right: 1px solid var(--border);
	display: flex;
	flex-direction: column;
	overflow: hidden;
	transition: transform 0.25s ease;
}

.sidebar-header {
	padding: 16px;
	border-bottom: 1px solid var(--border);
}

.sidebar-header h2 {
	font-size: 14px;
	font-weight: 600;
	color: var(--text-secondary);
	text-transform: uppercase;
	letter-spacing: 0.5px;
}

.file-tree {
	flex: 1;
	overflow-y: auto;
	padding: 8px 0;
}

/* ===== Tree Items ===== */
.tree-item {
	user-select: none;
}

.tree-link {
	display: flex;
	align-items: center;
	padding: 6px 12px;
	margin: 1px 4px;
	border-radius: 4px;
	cursor: pointer;
	transition: background 0.15s;
	text-decoration: none;
	color: var(--text-primary);
}

.tree-link:hover {
	background: var(--hover);
	text-decoration: none;
}

.tree-link.active {
	background: var(--active);
}

/* Arrow */
.arrow {
	width: 18px;
	height: 18px;
	display: flex;
	align-items: center;
	justify-content: center;
	margin-right: 2px;
	transition: transform 0.2s;
	opacity: 0.5;
}

.arrow svg {
	width: 12px;
	height: 12px;
	fill: currentColor;
}

.arrow.expanded { transform: rotate(90deg); }
.arrow.hidden { visibility: hidden; }

/* Icon */
.icon {
	margin-right: 8px;
	font-size: 15px;
}

.icon.folder { color: var(--folder-color); }
.icon.file { color: var(--file-color); }

/* Name */
.name {
	flex: 1;
	white-space: nowrap;
	overflow: hidden;
	text-overflow: ellipsis;
	font-size: 13px;
}

/* Children */
.children {
	display: none;
}

.children.open {
	display: block;
}

/* Indentation */
.tree-item[data-depth="0"] > .tree-link { padding-left: 8px; }
.tree-item[data-depth="1"] > .tree-link { padding-left: 24px; }
.tree-item[data-depth="2"] > .tree-link { padding-left: 40px; }
.tree-item[data-depth="3"] > .tree-link { padding-left: 56px; }
.tree-item[data-depth="4"] > .tree-link { padding-left: 72px; }

/* ===== Main Content ===== */
.content {
	flex: 1;
	overflow-y: auto;
	background: var(--bg-content);
	display: flex;
	flex-direction: column;
}

.breadcrumb {
	padding: 12px 24px;
	border-bottom: 1px solid var(--border);
	font-size: 12px;
	color: var(--text-secondary);
	background: var(--bg-primary);
	text-align: center;
}

.breadcrumb a {
	color: var(--text-secondary);
}

.breadcrumb a:hover {
	color: var(--accent);
}

.breadcrumb span {
	margin: 0 6px;
	opacity: 0.5;
}

.content-body {
	flex: 1;
	width: 100%;
	max-width: 816px; /* ~8.5in at 96dpi, loose-leaf paper width */
	margin: 0 auto;
	padding: 48px 40px;
	line-height: 1.7;
}

.content-body p { margin-bottom: 1em; color: var(--text-secondary); }
.content-body h1, .content-body h2, .content-body h3 { margin: 1em 0 0.5em; }

/* Content images: scale to 50% of natural size, constrained by frame */
.content-body img {
	transform: scale(0.5);
	transform-origin: top left;
	max-width: 200%; /* so 50% scale fits within the frame */
	height: auto;
	display: block;
	margin-bottom: 1em;
}

.content-body video,
.content-body audio {
	max-width: 100%;
	height: auto;
}

/* ===== Mobile Toggle ===== */
.menu-toggle {
	display: none;
	position: fixed;
	top: 6px;
	left: 12px;
	z-index: 400;
	width: 36px;
	height: 36px;
	background: var(--bg-secondary);
	border: 1px solid var(--border);
	border-radius: 6px;
	cursor: pointer;
	flex-direction: column;
	align-items: center;
	justify-content: center;
	gap: 4px;
}

.menu-toggle.hidden {
	display: none !important;
}

.menu-toggle span {
	display: block;
	width: 18px;
	height: 2px;
	background: var(--text-primary);
	transition: 0.2s;
}

.menu-toggle.active span:nth-child(1) { transform: rotate(45deg) translate(4px, 4px); }
.menu-toggle.active span:nth-child(2) { opacity: 0; }
.menu-toggle.active span:nth-child(3) { transform: rotate(-45deg) translate(4px, -4px); }

/* ===== Overlay ===== */
.overlay {
	display: none;
	position: fixed;
	inset: 0;
	background: rgba(0,0,0,0.6);
	z-index: 90;
}

.overlay.active { display: block; }

/* ===== Scrollbar ===== */
.file-tree::-webkit-scrollbar,
.content::-webkit-scrollbar { width: 6px; }
.file-tree::-webkit-scrollbar-thumb,
.content::-webkit-scrollbar-thumb { background: var(--border); border-radius: 3px; }

/* ===== Responsive ===== */
@media (max-width: 768px) {
	.menu-toggle:not(.hidden) { display: flex; }
	
	.sidebar {
		position: fixed;
		top: 48px;
		left: 0;
		height: calc(100% - 48px);
		z-index: 100;
		transform: translateX(-100%);
	}
	
	.sidebar.open { transform: translateX(0); }
	
	.content { padding-top: 50px; }
	
	.breadcrumb { padding-left: 60px; }
	
	.top-nav {
		padding: 0 12px;
		padding-left: 56px;
	}
	
	.top-nav.no-sidebar {
		padding-left: 12px;
	}
	
	.nav-link {
		padding: 6px 10px;
		font-size: 12px;
	}
}

@media (max-width: 480px) {
	.sidebar { width: 85%; min-width: 85%; }
	.content-body { padding: 24px 16px; }
}

/* ===== Home Page Layout (route-driven) ===== */
.home-page {
	justify-content: center;
}

.home-page .content {
	max-width: 800px;
	margin: 0 auto;
}

.home-hero {
	display: flex;
	flex-direction: column;
	align-items: center;
	justify-content: center;
	min-height: calc(80vh - 48px);
	text-align: center;
}

.home-hero h1 {
	font-size: 2.5rem;
	margin-bottom: 1rem;
}

.home-hero a {
	display: inline-block;
	margin-top: 1rem;
	padding: 12px 24px;
	background: var(--bg-secondary);
	border: 1px solid var(--border);
	border-radius: 8px;
	transition: background 0.2s;
}

.home-hero a:hover {
	background: var(--hover);
	text-decoration: none;
}
